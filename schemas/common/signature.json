{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://spp.dev/schemas/common/signature.json",
  "title": "Digital Signature",
  "description": "Reusable schema for representing a digital signature in SPS artefacts",
  "$comment": "vNext: add support for compact JWS strings, multiple signature suites (Ed25519, Secp256k1, Secp256r1), and linked data proofs for verifiable credentials.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "alg": {
      "type": "string",
      "description": "Signing algorithm identifier (JOSE/JWA or suite-specific)",
      "minLength": 1
    },
    "kid": {
      "type": "string",
      "description": "Key identifier (can be a DID URL or key fingerprint)",
      "minLength": 1
    },
    "sig": {
      "type": "string",
      "description": "Base64url-encoded signature value",
      "pattern": "^[A-Za-z0-9_-]+$",
      "minLength": 16
    },
    "signer": {
      "$ref": "https://spp.dev/schemas/common/did.json",
      "description": "DID of the signer"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "When the signature was created"
    }
  },
  "required": ["alg", "sig"]
}